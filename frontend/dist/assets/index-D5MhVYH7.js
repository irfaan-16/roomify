import{a9 as m,a6 as x,a8 as A,aa as O,ab as S,ac as N,ad as q,a7 as D}from"./index-HlxIaKFm.js";const j=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","isindex","keygen","link","menuitem","meta","nextid","param","source","track","wbr"];function v(n,a,e,t){return t.settings.bogusComments?"<?"+m(n.value,Object.assign({},t.settings.characterReferences,{subset:[">"]}))+">":"<!--"+n.value.replace(/^>|^->|<!--|-->|--!>|<!-$/g,s)+"-->";function s(i){return m(i,Object.assign({},t.settings.characterReferences,{subset:["<",">"]}))}}function k(n,a,e,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}function p(n){const a=n&&typeof n=="object"&&n.type==="text"?n.value||"":n;return typeof a=="string"&&a.replace(/[ \t\n\f\r]/g,"")===""}const o=_(1),w=_(-1);function _(n){return a;function a(e,t,s){const i=e?e.children:[];let l=(t||0)+n,r=i&&i[l];if(!s)for(;r&&p(r);)l+=n,r=i[l];return r}}const R={}.hasOwnProperty;function C(n){return a;function a(e,t,s){return R.call(n,e.tagName)&&n[e.tagName](e,t,s)}}const h=C({html:$,head:f,body:L,p:P,li:B,dt:H,dd:T,rt:y,rp:y,optgroup:z,option:U,menuitem:I,colgroup:f,caption:f,thead:V,tbody:Y,tfoot:F,tr:G,td:b,th:b});function f(n,a,e){const t=o(e,a,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&p(t.value.charAt(0)))}function $(n,a,e){const t=o(e,a);return!t||t.type!=="comment"}function L(n,a,e){const t=o(e,a);return!t||t.type!=="comment"}function P(n,a,e){const t=o(e,a);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!e||!(e.type==="element"&&(e.tagName==="a"||e.tagName==="audio"||e.tagName==="del"||e.tagName==="ins"||e.tagName==="map"||e.tagName==="noscript"||e.tagName==="video"))}function B(n,a,e){const t=o(e,a);return!t||t.type==="element"&&t.tagName==="li"}function H(n,a,e){const t=o(e,a);return t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function T(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function y(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function z(n,a,e){const t=o(e,a);return!t||t.type==="element"&&t.tagName==="optgroup"}function U(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function I(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="menuitem"||t.tagName==="hr"||t.tagName==="menu")}function V(n,a,e){const t=o(e,a);return t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function Y(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function F(n,a,e){return!o(e,a)}function G(n,a,e){const t=o(e,a);return!t||t.type==="element"&&t.tagName==="tr"}function b(n,a,e){const t=o(e,a);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const J=C({html:K,head:M,body:Q,colgroup:W,tbody:X});function K(n){const a=o(n,-1);return!a||a.type!=="comment"}function M(n){const a=n.children,e=[];let t=-1;for(;++t<a.length;){const s=a[t];if(s.type==="element"&&(s.tagName==="title"||s.tagName==="base")){if(e.includes(s.tagName))return!1;e.push(s.tagName)}}return a.length>0}function Q(n){const a=o(n,-1,!0);return!a||a.type!=="comment"&&!(a.type==="text"&&p(a.value.charAt(0)))&&!(a.type==="element"&&(a.tagName==="meta"||a.tagName==="link"||a.tagName==="script"||a.tagName==="style"||a.tagName==="template"))}function W(n,a,e){const t=w(e,a),s=o(n,-1,!0);return e&&t&&t.type==="element"&&t.tagName==="colgroup"&&h(t,e.children.indexOf(t),e)?!1:s&&s.type==="element"&&s.tagName==="col"}function X(n,a,e){const t=w(e,a),s=o(n,-1);return e&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&h(t,e.children.indexOf(t),e)?!1:s&&s.type==="element"&&s.tagName==="tr"}const u={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function Z(n,a,e,t){const s=t.schema,i=s.space==="svg"?!1:t.settings.omitOptionalTags;let l=s.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(n.tagName.toLowerCase());const r=[];let c;s.space==="html"&&n.tagName==="svg"&&(t.schema=x);const g=tt(t,n.properties),d=t.all(s.space==="html"&&n.tagName==="template"?n.content:n);return t.schema=s,d&&(l=!1),(g||!i||!J(n,a,e))&&(r.push("<",n.tagName,g?" "+g:""),l&&(s.space==="svg"||t.settings.closeSelfClosing)&&(c=g.charAt(g.length-1),(!t.settings.tightSelfClosing||c==="/"||c&&c!=='"'&&c!=="'")&&r.push(" "),r.push("/")),r.push(">")),r.push(d),!l&&(!i||!h(n,a,e))&&r.push("</"+n.tagName+">"),r.join("")}function tt(n,a){const e=[];let t=-1,s;if(a){for(s in a)if(a[s]!==void 0&&a[s]!==null){const i=et(n,s,a[s]);i&&e.push(i)}}for(;++t<e.length;){const i=n.settings.tightAttributes?e[t].charAt(e[t].length-1):null;t!==e.length-1&&i!=='"'&&i!=="'"&&(e[t]+=" ")}return e.join("")}function et(n,a,e){const t=A(n.schema,a),s=n.settings.allowParseErrors&&n.schema.space==="html"?0:1,i=n.settings.allowDangerousCharacters?0:1;let l=n.quote,r;if(t.overloadedBoolean&&(e===t.attribute||e==="")?e=!0:(t.boolean||t.overloadedBoolean&&typeof e!="string")&&(e=!!e),e==null||e===!1||typeof e=="number"&&Number.isNaN(e))return"";const c=m(t.attribute,Object.assign({},n.settings.characterReferences,{subset:u.name[s][i]}));return e===!0||(e=Array.isArray(e)?(t.commaSeparated?O:S)(e,{padLeft:!n.settings.tightCommaSeparatedLists}):String(e),n.settings.collapseEmptyAttributes&&!e)?c:(n.settings.preferUnquoted&&(r=m(e,Object.assign({},n.settings.characterReferences,{subset:u.unquoted[s][i],attribute:!0}))),r!==e&&(n.settings.quoteSmart&&N(e,l)>N(e,n.alternative)&&(l=n.alternative),r=l+m(e,Object.assign({},n.settings.characterReferences,{subset:(l==="'"?u.single:u.double)[s][i],attribute:!0}))+l),c+(r&&"="+r))}function E(n,a,e,t){return e&&e.type==="element"&&(e.tagName==="script"||e.tagName==="style")?n.value:m(n.value,Object.assign({},t.settings.characterReferences,{subset:["<","&"]}))}function nt(n,a,e,t){return t.settings.allowDangerousHtml?n.value:E(n,a,e,t)}function at(n,a,e,t){return t.all(n)}const st=q("type",{invalid:ot,unknown:it,handlers:{comment:v,doctype:k,element:Z,raw:nt,root:at,text:E}});function ot(n){throw new Error("Expected node, not `"+n+"`")}function it(n){throw new Error("Cannot compile unknown node `"+n.type+"`")}function rt(n,a){const e=a||{},t=e.quote||'"',s=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:lt,all:ct,settings:{omitOptionalTags:e.omitOptionalTags||!1,allowParseErrors:e.allowParseErrors||!1,allowDangerousCharacters:e.allowDangerousCharacters||!1,quoteSmart:e.quoteSmart||!1,preferUnquoted:e.preferUnquoted||!1,tightAttributes:e.tightAttributes||!1,upperDoctype:e.upperDoctype||!1,tightDoctype:e.tightDoctype||!1,bogusComments:e.bogusComments||!1,tightCommaSeparatedLists:e.tightCommaSeparatedLists||!1,tightSelfClosing:e.tightSelfClosing||!1,collapseEmptyAttributes:e.collapseEmptyAttributes||!1,allowDangerousHtml:e.allowDangerousHtml||!1,voids:e.voids||j,characterReferences:e.characterReferences||e.entities||{},closeSelfClosing:e.closeSelfClosing||!1,closeEmptyElements:e.closeEmptyElements||!1},schema:e.space==="svg"?x:D,quote:t,alternative:s}.one(Array.isArray(n)?{type:"root",children:n}:n,void 0,void 0)}function lt(n,a,e){return st(n,a,e,this)}function ct(n){const a=[],e=n&&n.children||[];let t=-1;for(;++t<e.length;)a[t]=this.one(e[t],t,n);return a.join("")}function gt(n){const a=this.data("settings"),e=Object.assign({},a,n);Object.assign(this,{Compiler:t});function t(s){return rt(s,e)}}export{gt as default};
